

This note covers non-linear spatial filters. Unlike linear filters, their output is not a weighted sum of input pixels. They are often more effective at specific tasks like removing impulsive noise or preserving edges during smoothing.

## Definition of a Non-Linear Filter

A non-linear filter operates on a pixel neighborhood, but the calculation used to determine the output pixel's value is not a linear combination (i.e., it is not convolution). The operation is based on ordering or selecting pixel values within the neighborhood.

### 1. Median Filter
The median filter is a powerful order-statistic filter, particularly effective against impulsive noise.

-   **Principle:** It replaces the value of each pixel with the *median* value of the intensities in a surrounding neighborhood.
-   **Process:**
    1.  Consider a neighborhood of pixels (e.g., a 3x3 window).
    2.  Collect the intensity values of all pixels in this neighborhood.
    3.  Sort the values in ascending order.
    4.  The output value for the center pixel is the middle value from the sorted list.
-   **Effect:**
    -   Excellent at removing salt-and-pepper noise.
    -   Significantly better at preserving sharp edges compared to linear filters like the mean filter.
-   **Insight:** The median filter's strength comes from its robustness to outliers. An extreme value (like a black or white pixel from noise) will be sorted to either the beginning or end of the list and will therefore not be chosen as the median. This prevents the outlier from influencing the output, which is not the case in an averaging operation.

### 2. Nagao Filter (Adaptive Filter)
The Nagao filter is an adaptive, edge-preserving smoothing filter. It modifies its behavior based on the local statistical properties of the image within a window.

-   **Principle:** To calculate the new value for a center pixel, it first identifies the most uniform (least variance) sub-region within a larger neighborhood and then uses the average of only that sub-region.
-   **Process:**
    1.  Define a main window around the current pixel (e.g., 5x5).
    2.  Divide this window into a set of smaller, overlapping sub-regions (e.g., nine 3x3 sub-regions).
    3.  Calculate the variance of the pixel values within each sub-region.
    4.  Identify the sub-region with the minimum variance.
    5.  The output value is the *mean* of the pixel values in this minimum-variance sub-region.
-   **Insight:** This adaptive process prevents blurring across edges. When the window is over a sharp edge, the sub-region with the lowest variance will be one that lies entirely on one side of the edge. By averaging only within this homogeneous region, the filter smooths noise without mixing pixel values from different sides of the contour, thus preserving the edge.